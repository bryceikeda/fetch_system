<?xml version="1.0"?>
<launch>
    <!-- Run MTC pick and place -->
    
    <!-- By default, we do not start a database (it can be large) -->
    <arg name="db" default="false" />

    <!-- By default, we are not in debug mode -->
    <arg name="debug" default="false" />

    <!-- Load the URDF, SRDF and other .yaml configuration files on the param server -->
    <include file="$(find fetch_moveit_config)/launch/planning_context.launch">
        <arg name="load_robot_description" value="true"/>
    </include>
   
    <!-- Run the main MoveIt executable -->
    <arg name="pipeline" default="$(optenv PLANNING_PIPELINE ompl)" />
    <include file="$(find fetch_moveit_config)/launch/move_group.launch">
        <arg name="allow_trajectory_execution" value="true"/>  
        <arg name="fake_execution" value="false"/>
        <arg name="info" value="true"/>
        <arg name="debug" value="$(arg debug)"/>
        <arg name="pipeline" value="$(arg pipeline)" />
    </include>
    
    <param name="move_group/capabilities" value="move_group/ExecuteTaskSolutionCapability" />
    <arg unless="$(arg debug)" name="launch_prefix" value="" />
    <arg     if="$(arg debug)" name="launch_prefix" value="gdb --ex run --args" />

    <arg name="rviz_config" default="$(find task_planner)/config/fetch_mtc.rviz" />
    <arg     if="$(eval rviz_config=='')" name="command_args" value="" />
    <arg unless="$(eval rviz_config=='')" name="command_args" value="-d $(arg rviz_config)" />

    <node name="$(anon rviz)" launch-prefix="$(arg launch_prefix)" pkg="rviz" type="rviz" respawn="false" args="$(arg command_args)" output="screen">
        <rosparam command="load" file="$(find fetch_moveit_config)/config/kinematics.yaml"/>
    </node>
</launch>
